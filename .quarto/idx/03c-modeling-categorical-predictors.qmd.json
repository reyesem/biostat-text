{"title":"Incorporating Categorical Predictors","markdown":{"headingText":"Incorporating Categorical Predictors","headingAttr":{"id":"sec-modeling-categorical-predictors","classes":[],"keyvalue":[]},"containsRefs":false,"markdown":"\n{{< include _setupcode.qmd >}}\n\nThe general linear model framework (@def-general-linear-model) is quite flexible; in particular, it allows us to consider not only quantitative predictors, but also categorical (qualitative) predictors.  Our strategy is to define a new set of quantitative variables which capture the group membership appropriately.\n\n:::{#exm-perceived-stress}\n## Perceived Stress\nThe _Perceived Stress Scale (PSS)_ is a widely used psychological instrument for measuring the perception of stress. Subjects answer ten short questions regarding the degree to which situations in their life are viewed as stressful, and the responses are codified into a score between 0 and 40 (higher values indicate higher stress). Suppose we were interested in modeling the PSS score among college students as a function of their class standing (Freshman, Sophomore, Junior, Senior) and the number of hours of sleep the student reports getting on a typical night.  The first few records in our data might hypothetically look like that illustrated in @tbl-modeling-categorical-predictors-stress-data.\n:::\n\n```{r}\n#| label: tbl-modeling-categorical-predictors-stress-data\n#| tbl-cap: Hypothetical data on stress in college students.\n#| echo: false\n\nset.seed(123)\n\nmydat <- tibble(\n  `Subject ID` = sample((1001:2000), size = 10, replace = FALSE),\n  PSS = sample(40, size = length(`Subject ID`), replace = TRUE),\n  `Hours Sleep` = sample(seq(4, 9, by = 0.5), size = length(`Subject ID`),\n                         replace = TRUE),\n  `Class Standing` = sample(c(\"Freshman\", \"Sophomore\", \"Junior\", \"Senior\"),\n                            size = length(`Subject ID`), replace = TRUE)\n)\n\nmydat |>\n  mykable()\n```\n\nIt does not take long to recognize that forming a model like\n\n$$(\\text{PSS Score})_i = \\beta_0 + \\beta_1 (\\text{Hours Sleep})_i + \\beta_2 (\\text{Class Standing})_i + \\varepsilon_i$$\n\ndoes not work.  Since class standing is a categorical variable, plugging in does not make sense; that is, what does it mean to multiply $\\beta_2$ by \"Junior\"?  We need a way of somehow bringing the categorical predictor into the linear model.  Before stating our approach, let's first consider two common naive approaches:\n\n  - Replace each level of the categorical predictor with a number: convert Freshman to 1, Sophomore to 2, Junior to 3, and Senior to 4; enter this numeric variable into a regression model.\n  - Construct different data sets for each level of the categorical predictor: four data sets in this case with one for Freshman, one for Sophomore, one for Junior, and one for Senior; conduct a different analysis on each set of data.\n\nThe first approach solves the \"number times word\" problem.  We could certainly fit such a model.  However, this approach is limiting.  It assumes a linear trend across the levels of the categorical predictor.  Are we sure that the stress either increases or decreases as the class standing increases?  Do we want to allow the stress to be highest during the sophomore year?  More problematic are categorical predictors which have no natural ordering (e.g., eye color); how do we determine the mapping from text to numbers in that case?  \n\nThe second approach sounds reasonable at first glance.  It would yield four different models:\n\n$$\n\\begin{aligned}\n  \\text{Model 1}:& (\\text{PSS Score})_i = \\gamma_{\\text{FR}} + \n    \\alpha_{\\text{FR}} (\\text{Hours Sleep})_i + \\varepsilon_{1,i} \\\\\n  \\text{Model 2}:& (\\text{PSS Score})_i = \\gamma_{\\text{SO}} + \n    \\alpha_{\\text{SO}} (\\text{Hours Sleep})_i + \\varepsilon_{2,i} \\\\\n  \\text{Model 3}:& (\\text{PSS Score})_i = \\gamma_{\\text{JR}} + \n    \\alpha_{\\text{JR}} (\\text{Hours Sleep})_i + \\varepsilon_{3,i} \\\\\n  \\text{Model 4}:& (\\text{PSS Score})_i = \\gamma_{\\text{SR}} + \n    \\alpha_{\\text{SR}} (\\text{Hours Sleep})_i + \\varepsilon_{4,i}.\n\\end{aligned}\n$$\n\nIn these models, we have different parameters for each group.  The problem is that we no longer have a single estimate for the impact of the number of hours of sleep; we have a different estimate for each group.  Further, we would have a different estimate of the residual variance for each model, which would not align with the condition of assuming the variance is constant for all values of the predictors.  This approach diminishes the power of the study, and it does not make it easy to address some questions of interest (such as, do freshman and sophomores differ in their PSS score?).\n\nNeither of these approaches seems to fully capture our goal.  Instead, we create multiple new variables that capture the qualitative grouping.  Consider defining new variables as follows\n\n$$\n\\begin{aligned}\n  (\\text{Sophomore})_i &= \\begin{cases}\n    1 & \\text{if i-th subject is a sophomore} \\\\\n    0 & \\text{otherwise}\n    \\end{cases} \\\\\n  (\\text{Junior})_i &= \\begin{cases}\n    1 & \\text{if i-th subject is a junior} \\\\\n    0 & \\text{otherwise}\n    \\end{cases} \\\\\n  (\\text{Senior})_i &= \\begin{cases}\n    1 & \\text{if i-th subject is a senior} \\\\\n    0 & \\text{otherwise.}\n    \\end{cases}\n\\end{aligned}\n$$\n      \nAugmenting our original data set with these new predictors would result in the data set illustrated in @tbl-modeling-categorical-predictors-stress-data-aug.\n\n```{r}\n#| label: tbl-modeling-categorical-predictors-stress-data-aug\n#| tbl-cap: Hypothetical data on stress in college students augmented to include additional variables capturing the class standing.\n#| echo: false\n\nmydat |>\n  mutate(\n    Sophomore = case_when(\n      `Class Standing` == \"Sophomore\" ~ 1,\n      TRUE ~ 0\n    ),\n    Junior = case_when(\n      `Class Standing` == \"Junior\" ~ 1,\n      TRUE ~ 0\n    ),\n    Senior = case_when(\n      `Class Standing` == \"Senior\" ~ 1,\n      TRUE ~ 0\n    )\n  ) |>\n  mykable()\n```\n\nUsing these additional variables, consider the model\n\n$$\n\\begin{aligned}\n  (\\text{PSS Score})_i &= \\beta_0 + \\beta_1 (\\text{Hours Sleep})_i + \\beta_2 (\\text{Sophomore})_i \\\\\n    &\\qquad + \\beta_3 (\\text{Junior})_i + \\beta_4 (\\text{Senior})_i + \\varepsilon_i.\n\\end{aligned}\n$$\n\nThis model embeds the grouping structure while only having one parameter for the effect of sleep on the PSS score and one parameter for the residual variance.  You might at first think \"what happened to freshman?\"  To see what is really happening with this model, think about what the structure provides us.  Suppose we are considering freshman students who get $x$ hours of sleep; for this group of students, the value of the variables `Sophomore`, `Junior`, and `Senior` are all zero.  Plugging into the deterministic portion of the model, we find that the average PSS score for this group is\n\n$$\\beta_0 + \\beta_1 x + \\beta_2 (0) + \\beta_3 (0) + \\beta_4 (0) = \\beta_0 + \\beta_1 x.$$\n\nThe fact that each of the variables `Sophomore`, `Junior`, and `Senior` take either the value 0 or 1 makes the arithmetic work out nicely.  We can easily write down the average PSS score for each group for a specific number of hours of sleep:\n\n$$\n\\begin{aligned}\n  E\\left[\\text{PSS Score} \\mid \\text{Hours Sleep, Freshman}\\right]\n    &= \\beta_0 + \\beta_1 (\\text{Hours Sleep}) \\\\\n  E\\left[\\text{PSS Score} \\mid \\text{Hours Sleep, Sophomore}\\right]\n    &= \\left(\\beta_0 + \\beta_2\\right) + \\beta_1 (\\text{Hours Sleep})\\\\\n  E\\left[\\text{PSS Score} \\mid \\text{Hours Sleep, Junior}\\right]\n    &= \\left(\\beta_0 + \\beta_3\\right) + \\beta_1 (\\text{Hours Sleep}) \\\\\n  E\\left[\\text{PSS Score} \\mid \\text{Hours Sleep, Senior}\\right]\n    &= \\left(\\beta_0 + \\beta_4\\right) + \\beta_1 (\\text{Hours Sleep}). \\\\\n\\end{aligned}\n$$\n      \nSo, freshman did not disappear from the model; they were there all along in the intercept.  This strategy relies on capturing the grouping structure through a series of binary (0 or 1) variables, known as indicator variables.\n\n:::{#def-indicator-variables}\n## Indicator Variables\nAlso called \"dummy variables,\" these are a set of binary variables that capture the grouping defined by a categorical variable for regression modeling.\n:::\n\nIndicator variables are like light switches that click on or off in order to specify that a particular subject (or population of subjects) with the corresponding characteristic is being considered.  The way that we have defined these variables ensures that no two light switches are on at the same time; each subject is a member of exactly one group (a student must have a class standing and cannot have two class standings simultaneously; that is, a student cannot be classified as both a freshman and a sophomore).\n\n:::{.callout-note}\nA categorical predictor with $k$ groups/levels requires $k-1$ indicator variables to fully capture the grouping structure.\n:::\n\nOne group (known as the reference group) will always be captured by the intercept term; the choice of this group is arbitrary and is often chosen by the software package (perhaps alphabetically, for example).  Note that if the only difference between two models is the choice of the reference group, the models result in equivalent inference (though the interpretation of the parameters differs).\n\n:::{#def-reference-group}\n## Reference Group\nThe group defined by having all indicator variables for a particular categorical variable set to zero.\n:::\n\nRecall that provided the \"mean 0\" condition on the error holds, we have an interpretation of the coefficients in the model (@def-slope).  This yields a nice interpretation of the coefficients for indicator variables.\n\n:::{.callout-note}\n## Interpretation of Coefficient for Indicator\nLet $\\beta$ be the parameter corresponding to an indicator variable in a linear model; then, $\\beta$ is the difference in the _average_ response between the group defined by that indicator taking the value 1 and the reference group _holding all other predictors fixed_.\n:::\n\nThis does create a situation we have not yet encountered.  Suppose we are interested in determining if the PSS score is associated with class standing after accounting for the hours of sleep the student gets on a typical night.  The hypothesis is no longer of the form\n\n$$H_0: \\beta_j = 0 \\qquad \\text{vs.} \\qquad H_1: \\beta_j \\neq 0$$\n\nfor some $j$.  Instead, there are several predictors in the model which capture class standing.  We need to instead consider testing multiple parameters _simultanesously_.\n\n:::{.callout-tip}\n## Big Idea\nThe statistical significance of a categorical predictor is assessed by testing if _all_ corresponding indicator variables are simultaneously 0.\n:::\n\nIn our case, we would be testing a hypothesis of the form\n\n$$H_0: \\beta_2 = \\beta_3 = \\beta_4 = 0 \\qquad \\text{vs.} \\qquad H_1: \\text{at least one of these } \\beta_j \\text{ not equal to 0}.$$\n\nWe will address hypotheses of this form in @sec-modeling-linear-hypotheses.\n\nWe end this section by stating that while our discussion centered on the inclusion of categorical predictors in the linear model, this is a general modeling technique.  Regardless of the type of regression model, categorical predictors can be included through the use of indicator variables.\n \n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"center","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["mystyles.css"],"output-file":"03c-modeling-categorical-predictors.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","bibliography":["refs482notes.bib","packages.bib"],"comments":{"hypothesis":false},"fig-cap-location":"bottom","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":true,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"center","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"03c-modeling-categorical-predictors.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"bibliography":["refs482notes.bib","packages.bib"],"comments":{"hypothesis":false},"fig-cap-location":"bottom","documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}