<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistical Modeling for the Biological Sciences - 17&nbsp; Relaxing the Constant Variance Condition</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05d-nlm-logistic.html" rel="next">
<link href="./05b-nlm-model-framework.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="mystyles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05a-nlm.html">Unit V: Nonlinear Models</a></li><li class="breadcrumb-item"><a href="./05c-nlm-heteroskedasticity.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Relaxing the Constant Variance Condition</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Biostatistics</a> 
        <div class="sidebar-tools-main">
    <a href="./ma482-text.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01a-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit I: Review of Statistics and Probability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01b-statistical-process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Overview of the Statistical Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01c-distributional-quartet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Distributional Quartet</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01d-essential-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Essential Probability</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02a-glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit II: General Linear Model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02b-glm-model-framework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">General Linear Model Framework</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02c-glm-assessing-conditions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Assessing the Conditions for the General Linear Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02d-glm-unifying-framework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The General Linear Model as a Unifying Framework</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03a-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit III: General Modeling Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03b-modeling-related-predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Addressing Relationships Between Predictors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03c-modeling-categorical-predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Incorporating Categorical Predictors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03d-modeling-interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Allowing Effect Modification (Interaction Terms)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03e-modeling-linear-hypotheses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">General Linear Hypothesis Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03f-modeling-large-sample-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Large Sample Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03g-modeling-splines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Modeling Curvature (Splines)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./04a-rm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit IV: Models for Repeated Measures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04b-rm-terminology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Language of Repeated Measures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04c-rm-mixed-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Mixed Effects Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04d-rm-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./05a-nlm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit V: Nonlinear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05b-nlm-model-framework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Nonlinear Model Framework</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05c-nlm-heteroskedasticity.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Relaxing the Constant Variance Condition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05d-nlm-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05e-nlm-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Model Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05f-nlm-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Estimation Details for Nonlinear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05g-nlm-rm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Nonlinear Models with Repeated Measures</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./06a-surv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit VI: Survival Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06b-surv-terminology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">The Language of Survival Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06c-surv-censoring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Censoring</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06d-surv-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Basic Estimation and Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06e-surv-cph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Proportional Hazards Model</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#conditions-for-nonlinear-models" id="toc-conditions-for-nonlinear-models" class="nav-link active" data-scroll-target="#conditions-for-nonlinear-models"><span class="header-section-number">17.1</span> Conditions for Nonlinear Models</a></li>
  <li><a href="#modeling-the-variance" id="toc-modeling-the-variance" class="nav-link" data-scroll-target="#modeling-the-variance"><span class="header-section-number">17.2</span> Modeling the Variance</a></li>
  <li><a href="#wild-bootstrap" id="toc-wild-bootstrap" class="nav-link" data-scroll-target="#wild-bootstrap"><span class="header-section-number">17.3</span> Wild Bootstrap</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-nlm-heteroskedasticity" class="quarto-section-identifier"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Relaxing the Constant Variance Condition</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>We proposed a semiparametric approach for specifying nonlinear models (<a href="05b-nlm-model-framework.html#def-semiparametric-nonlinear-model">Definition&nbsp;<span>16.2</span></a>). In this chapter, we first discuss the conditions imposed in this approach; then, we consider how these conditions might be relaxed. Specifically, we discuss methods for relaxing the “constant variance” condition.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>While we introduce methods for relaxing the “constant variance” condition within the context of nonlinear models, these methods are applicable to a wider range of models including linear models and models for repeated measures data.</p>
</div>
</div>
<section id="conditions-for-nonlinear-models" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="conditions-for-nonlinear-models"><span class="header-section-number">17.1</span> Conditions for Nonlinear Models</h2>
<p><a href="05b-nlm-model-framework.html"><span>Chapter&nbsp;16</span></a> introduced the nonlinear modeling framework, a semiparametric approach for modeling the data generating process, and methods for estimating the parameters of the model. While a semiparametric model is quite flexible, its specification does place certain conditions on the data generating process.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Conditions for the Semiparametric Nonlinear Model
</div>
</div>
<div class="callout-body-container callout-body">
<p>A semiparametric model places the following conditions on the data generating process:</p>
<ul>
<li>The mean response function is correctly specified.</li>
<li>Given the value of the predictors, the response for one observation is independent of the response for all other observations.</li>
<li>The variability of the response is the same for all values of the predictor (also known as “homoskedasticity” or “constant variance”).</li>
</ul>
</div>
</div>
<p>These are essentially the same first three conditions we imposed in the general linear model framework (<a href="02b-glm-model-framework.html#def-classical-regression">Definition&nbsp;<span>4.3</span></a>); since the linear model is a special case of the nonlinear model, it should not come as a surprise that we impose the same conditions. As the conditions imposed on our nonlinear model are the same as those imposed in the general linear model framework, the conditions can be assessed in the same way — residual graphics. We can define the residual for the <span class="math inline">\(i\)</span>-th observed value as</p>
<p><span class="math display">\[
\begin{aligned}
  (\text{Residual})_i &amp;= (\text{Observed Response})_i - (\text{Predicted Mean Response})_i \\
    &amp;= (\text{Observed Response})_i - f\left((\text{Predictors})_i, \widehat{\boldsymbol{\beta}}\right).
\end{aligned}
\]</span></p>
<p>A plot of the residuals against the predicted values can be used to assess whether the mean response function is correctly specified. If this condition is met, we would expect the residuals to balance around zero for all predicted values. Recall that for nonlinear models, the mean response function is often the result of scientific theory; therefore, assessing this “mean-0” condition allows us to assess if the process we are observing is behaving according to the scientific theory underlying the model.</p>
<p>When the order in which the data was collected is known, we can use a time-series plot of the residuals to assess whether it is reasonable to assume the responses are independent of one another. If the response, given the predictors, of one observation is independent of the response for all other observations, we would not expect to observe any trends in the location or spread of the time-series plot. As with the linear model, we note that this graphic can only detect dependence across time; we should rely on the context to determine if there are additional reasons to suspect dependence (such as repeated measures).</p>
<p>Finally, we can assess the condition imposed on the variability using a plot of the residuals against the predicted values. If the variance of the response has been correctly specified, then we would expect the spread of the residuals to remain fairly constant as we move left-to-right across the plot.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nonlinear modeling applications often have small samples. As a result, it can be difficult to assess constant variance from the plot of the residuals against the fitted values. A “trick” is to plot the absolute value of the residuals against the fitted values. This “doubles” the visual information in the graphic and can allow us to more easily pick up trends in the spread.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>While we do not assume the response (conditional on the predictors) follows a Normal distribution, if we had, we could assess this condition using a probability plot of the residuals.</p>
</div>
</div>
<div id="exm-nlm-indomethacin" class="theorem example">
<p><span class="theorem-title"><strong>Example 17.1 (Pharmacokinetics of Indomethacin) </strong></span>Indomethacin is a non-steroidal anti-inflammatory (NSAID) pain reliever used to treat severe pain and prevent premature labor in some cases. A study was conducted to examine the pharmacokinetic properties of the drug. Indomethacin is given as an IV-bolus and travels through the blood and deeper tissues. Scientists model this as a “two-compartment open model.” This approach leads to the following nonlinear model for the concentration <span class="math inline">\(C(t)\)</span> of the drug at any time <span class="math inline">\(t\)</span>:</p>
<p><span class="math display">\[C(t) = \beta_1 e^{-\beta_2 t} + \beta_3 e^{-\beta_4 t}\]</span></p>
<p>which is also known as the bi-exponential model with four parameters, <span class="math inline">\(\beta_1, \beta_2, \beta_3,\)</span> and <span class="math inline">\(\beta_4\)</span>.</p>
<p>Blood samples were taken periodically (over the course of 8 hours) from a single subject after being given an IV-bolus of the drug. The data is shown in <a href="#fig-nlm-indomethacin-plot">Figure&nbsp;<span>17.1</span></a>.</p>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-nlm-indomethacin-plot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./images/fig-nlm-indomethacin-plot-1.png" class="img-fluid figure-img" style="width:80.0%" alt="Scatterplot with a best fit line overlaid."></p>
<figcaption class="figure-caption">Figure&nbsp;17.1: Concentration of Indomethacin in the bloodstream for a single subject after being given an IV-bolus of the drug. The estimated bi-esponential model is overlaid.</figcaption>
</figure>
</div>
</div>
</div>
<p>Given the researchers’ beliefs, we might posit the following nonlinear model:</p>
<p><span id="eq-nlm-indometh-nlm"><span class="math display">\[
\begin{aligned}
  E\left[(\text{Concentration})_i \mid (\text{Time})_i\right]
    &amp;= \beta_1 e^{-\beta_2 (\text{Time})_i} + \beta_3 e^{-\beta_4 (\text{Time})_i} \\
  Var\left[(\text{Concentration})_i \mid (\text{Time})_i\right]
    &amp;= \sigma^2.
\end{aligned}
\tag{17.1}\]</span></span></p>
<p>The unknown parameters are estimated using the method of least squares (<a href="05f-nlm-estimation.html"><span>Chapter&nbsp;20</span></a>); and, we can assess the conditions using the residuals. <a href="#fig-nlm-indometh-resids">Figure&nbsp;<span>17.2</span></a> plots the residuals against the predicted values; and, it plots the absolute value of the residuals against the fitted values. In the first panel, we see the residuals tend to balance around 0 at all predicted responses; that is, the data is consistent with the two-compartment open model suggested by researchers (that led to the bi-exponential nonlinear model). However, in both the first and second panel, it is clear that the spread of the residuals increases as the predicted concentration increases. That is, we measure small concentrations with more precision than large concentrations.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-nlm-indometh-resids" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./images/fig-nlm-indometh-resids-1.png" class="img-fluid figure-img" style="width:80.0%" alt="The left panel is a scatterplot of the residuals against predicted values; the right panel is a scatterplot of the absolute residuals against the predicted values."></p>
<figcaption class="figure-caption">Figure&nbsp;17.2: Plot of the residuals against the predicted values for data from a study of the pharmacokinetics of Indothemacin.</figcaption>
</figure>
</div>
</div>
</div>
<p>Recall that misspecifying the variance does not mean that our parameter <em>estimates</em> are inappropriate. However, incorrectly assuming the variance is constant results in an inappropriate model for the sampling distribution of those estimates, which in turn means our confidence intervals and p-values may be unreliable.</p>
<p>In <a href="04d-rm-gee.html"><span>Chapter&nbsp;15</span></a>, we mentioned that using the robust sandwich estimator of the variance-covariance matrix adjusts for departures from constant variance. While this was done in the context of repeated measures, the robust sandwich estimator can be employed in settings where we know each observation is independent.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The robust sandwich estimator is sometimes referred to as the Huber sandwich estimator, the White estimator, or the Huber-White estimator.</p>
</div>
</div>
<p>In the remainder of this chapter, we consider two additional approaches to addressing departures from homoskedasticity.</p>
</section>
<section id="modeling-the-variance" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="modeling-the-variance"><span class="header-section-number">17.2</span> Modeling the Variance</h2>
<p>Notice that to assess the condition of constant variance, we plot the residuals against the predicted values. This is not necessarily intuitive. In fact, the condition states that the variability of the response is constant for all values of the predictors; so, it may seem more reasonable to plot the residuals against each predictor. In fact, this is sometimes taught in other texts and routinely done by analysts, and there is nothing wrong with that approach. We advocate for plotting the residuals against the predicted values because it highlights a common phenomena — the variability of the response often depends on the <em>value</em> of the response.</p>
<p>In our discussion in the previous section, we noted that <a href="#fig-nlm-indometh-resids">Figure&nbsp;<span>17.2</span></a> illustrates that as the concentration increases, the variability in the concentration tends to increase as well. That is, we have much more precision when measuring small concentrations, and we have much less precision when measuring large concentrations. When we have some sense of how the variability behaves, especially as a function of the mean response, we can model that structure.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Big Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>When we can specify how a component of the response distribution (such as the mean or variance) behaves, we can incorprate it into the model.</p>
</div>
</div>
<div id="def-nlm-gls" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 17.1 (Generalized Least Squares) </strong></span>The semiparametric nonlinear model can be generalized to capture non-constant variance. Specifically, we specify the <em>mean</em> and <em>variance</em> of the response given the predictors</p>
<p><span class="math display">\[
\begin{aligned}
  E\left[(\text{Response})_i \mid (\text{Predictors})_i\right]
    &amp;= f\left((\text{Predictors})_i, \boldsymbol{\beta}\right) \\
  Var\left[(\text{Response})_i \mid (\text{Predictors})_i\right]
    &amp;= g\left((\text{Predictors})_i, \boldsymbol{\beta}, \boldsymbol{\gamma}\right).
\end{aligned}
\]</span></p>
<p>Such a model is fit with the method of generalized least squares (as opposed to “ordinary” least squares) in which we alternate between (a) minimizing a weighted distance between the observed response and the mean function and (b) minimizing the distance between the squared residuals and the variance function. That is, we minimize</p>
<p><span class="math display">\[
\begin{aligned}
  &amp;\sum_{i=1}^{n} \frac{1}{g\left((\text{Predictors})_i, \boldsymbol{\beta}, \boldsymbol{\gamma}\right)} \left[(\text{Response})_i - f\left((\text{Predictors})_i, \boldsymbol{\beta}\right)\right]^2 \\
  &amp;\sum_{i=1}^{n} \left(g\left((\text{Predictors})_i, \boldsymbol{\beta}, \boldsymbol{\gamma}\right) - \left[(\text{Response})_i - f\left((\text{Predictors})_i, \boldsymbol{\beta}\right)\right]^2\right)^2.
\end{aligned}
\]</span></p>
</div>
<p>Essentially, this approach down-weights responses which have less precision when fitting the model. As an iterative process, it allows the parameters in the mean model to be updated based on the variance estimates, and the estimates in the variance function to be updated based on the mean estimates. Further, allowing the variance function to depend on the parameters in the mean response function captures behaviors like that in the Indomethacin example where the variability is dependent upon the values of the response. A popular model is the power of the mean model.</p>
<div id="def-pom" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 17.2 (Power of the Mean Model) </strong></span>The power of the mean model allows the variance to be specified as a power of the mean response function. Specifically, we consider</p>
<p><span class="math display">\[
\begin{aligned}
  E\left[(\text{Response})_i \mid (\text{Predictors})_i\right]
    &amp;= f\left((\text{Predictors})_i, \boldsymbol{\beta}\right) \\
  Var\left[(\text{Response})_i \mid (\text{Predictors})_i\right]
    &amp;= \sigma^2 \left[f\left((\text{Predictors})_i, \boldsymbol{\beta}\right)\right]^{2\theta}
\end{aligned}
\]</span></p>
</div>
<p>The details of implementing generalized least squares are beyond the scope of this text. We simply mention that this is a method for addressing heteroskedasticity (non-constant variance). Implementing generalized least squares results in appropriate inference about the parameters in the mean model. Large sample theory is relied upon to develop these sampling distributions.</p>
</section>
<section id="wild-bootstrap" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="wild-bootstrap"><span class="header-section-number">17.3</span> Wild Bootstrap</h2>
<p><a href="03f-modeling-large-sample-theory.html"><span>Chapter&nbsp;11</span></a> introduced the residual bootstrap as a method of relaxing distributional conditions. Specifically, the residual bootstrap avoided the need to assume the errors in a linear model followed a Normal distribution. However, it still required assuming the variability of the errors was constant; that is what allowed us to resample from the residuals during the algorithm. In this section, we extend these ideas to overcome heteroskedasticity in nonlinear models.</p>
<p>At first glance, it is not obvious why an additional algorithm for bootstrapping is necessary. In addition to the residual bootstrap, we discussed case-resampling as a method of bootstrapping. Case-resampling does not require that we assume the variability of the response is constant for all values of the predictor. However, the performance of this particular algorithm can be quite poor in nonlinear settings due to the lower sample sizes that are common. In particular, fitting a nonlinear model can be very unstable. If, when resampling the cases, we do not observe data in key regions that define the curvature, the numerical algorithms underlying the minimization can fail to converge to a solution. As an example, consider the Indomethacin data in <a href="#fig-nlm-indomethacin-plot">Figure&nbsp;<span>17.1</span></a>. Suppose that we performed a single bootstrap resample in which we resampled <span class="math inline">\(n = 11\)</span> observations, with resampling, at random. It is quite possible that we end up with a resample containing only data between times 2 and 8 (see <a href="#fig-nlm-indomethacin-resample-plot">Figure&nbsp;<span>17.3</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-nlm-indomethacin-resample-plot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./images/fig-nlm-indomethacin-resample-plot-1.png" class="img-fluid figure-img" style="width:80.0%" alt="Scatterplot of data."></p>
<figcaption class="figure-caption">Figure&nbsp;17.3: Potential bootstrap resample of the Indomethacin data resulting from case resampling. In this resample, the primary curvature present in the original data is lost.</figcaption>
</figure>
</div>
</div>
</div>
<p>This bootstrap resample inadvertently misses the concentrations measured early in time which define the curvature in the data. As a result, attempting to fit the bi-exponential model in <a href="#eq-nlm-indometh-nlm">Equation&nbsp;<span>17.1</span></a> fails. This failure is not the result of specific software limitations; the failure is a result of not having adequate data to capture the curvature expressed in the model.</p>
<p>So, while case-resampling avoids assuming constant variance, it can fail spectacularly in some nonlinear models. The residual bootstrap, on the other hand, assumes constant variance, but it maintains the curvature as the same predictor values are used when constructing each bootstrap resample. Pseudo-responses are generated in each bootstrap resample by adding a sample of the residuals to the fitted values (“jittering” the fitted line so to speak). The wild bootstrap is an alteration of the residual bootstrap which relaxes the assumption of constant variance while maintaining this beneficial property of the residual bootstrap.</p>
<div id="def-wild-bootstrap" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 17.3 (Wild Bootstrap) </strong></span>Suppose we observe a sample of size <span class="math inline">\(n\)</span> and use it to fit the mean model (linear or nonlinear)</p>
<p><span class="math display">\[E\left[(\text{Response})_i \mid (\text{Predictors})_i\right]= f\left((\text{Predictors})_i, \boldsymbol{\beta}\right)\]</span></p>
<p>to obtain the ordinary least squares estimates <span class="math inline">\(\widehat{\boldsymbol{\beta}}\)</span>. The wild bootstrap proceeds along the following algorithm:</p>
<ol type="1">
<li>Compute the residuals <span class="math display">\[(\text{Residual})_i = (\text{Response})_i - f\left((\text{Predictors})_i, \widehat{\boldsymbol{\beta}}\right)\]</span></li>
<li>Construct new pseudo-residuals <span class="math inline">\(e_1^*, \dotsc, e_n^*\)</span> by multiplying each residual by a random variable <span class="math inline">\(U\)</span> such that <span class="math inline">\(E\left(U_i\right) = 0\)</span> and <span class="math inline">\(Var\left(U_i\right) = 1\)</span>, for example <span class="math inline">\(U_i \sim N(0,1)\)</span>: <span class="math display">\[e_i^* = U_i (\text{Residual})_i\]</span></li>
<li>Form “new” responses <span class="math inline">\(y_1^*, \dotsc, y_n^*\)</span> according to <span class="math display">\[y_i^* = f\left((\text{Predictors})_i, \widehat{\boldsymbol{\beta}}\right) + e_i^*.\]</span></li>
<li>Obtain the least squares estimates <span class="math inline">\(\widehat{\boldsymbol{\alpha}}\)</span> by finding the values of <span class="math inline">\(\boldsymbol{\alpha}\)</span> which minimize <span class="math display">\[\sum_{i=1}^{n} \left(y_i^* - f\left((\text{Predictors})_i, \boldsymbol{\alpha}\right)\right)^2.\]</span></li>
<li>Repeat steps 2-4 <span class="math inline">\(m\)</span> times.</li>
</ol>
<p>We often take <span class="math inline">\(m\)</span> to be large (at least 1000). After each pass through the algorithm, we retain the least squares estimates <span class="math inline">\(\widehat{\boldsymbol{\alpha}}\)</span> from the resample. The distribution of the estimates across the resamples is a good empirical model for the sampling distribution of the original least squares estimates.</p>
</div>
<p>The wild bootstrap alters the residuals (as opposed to resampling them as in the residual bootstrap) to mimic the variability of the response being potentially unique for each observation. The theoretical underpinnings are beyond the scope of this text, but intuitively, we are adding noise to the line (“jittering” the predicted model) such that the noise has mean zero (meaning the model is still correctly specified) and has variance of the same magnitude as the original observation (captured by the magnitude of the residual).</p>
<p>This process is computationally intensive but can dramatically improve inference when necessary. For the data from <a href="#exm-nlm-indomethacin">Example&nbsp;<span>17.1</span></a>, <a href="#fig-nlm-indometh-sampdistns-plot">Figure&nbsp;<span>17.4</span></a> compares the model for the sampling distribution of <span class="math inline">\(\widehat{\beta}_3\)</span> assuming constant variance and after implementing a wild bootstrap. Assuming constant variance, our 95% CI for <span class="math inline">\(\beta_3\)</span> is (-0.03, 0.41); after implementing a wild bootstrap, we have a 95% CI for <span class="math inline">\(\beta_3\)</span> of (0.11, 0.40).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-nlm-indometh-sampdistns-plot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./images/fig-nlm-indometh-sampdistns-plot-1.png" class="img-fluid figure-img" style="width:80.0%" alt="Two density plots; the left panel is shifted to the left compared to the right panel."></p>
<figcaption class="figure-caption">Figure&nbsp;17.4: Comparison of two models for the sampling distribution of a parameter in the bi-exponential model fit to data examining the pharmacokinetics of Indomethacin. The left panel is the model for the sampling distribution based on large sample theory when we assume the variance is constant; the right panel is the model for the sampling distribution based on a wild bootstrap.</figcaption>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./05b-nlm-model-framework.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Nonlinear Model Framework</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05d-nlm-logistic.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>